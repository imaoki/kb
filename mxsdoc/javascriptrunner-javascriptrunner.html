<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rock+Salt">
<link rel="stylesheet" href="https://imaoki.github.io/mxskb/assets/css/icon.css">
<link rel="stylesheet" href="https://imaoki.github.io/mxskb/assets/css/normalize.css">
<link rel="stylesheet" href="https://imaoki.github.io/mxskb/assets/css/theme.css">
<link rel="stylesheet" href="https://imaoki.github.io/mxskb/assets/css/syntax.css">
<link rel="stylesheet" href="https://imaoki.github.io/mxskb/assets/css/photoswipe.css">
<link rel="stylesheet" href="https://imaoki.github.io/mxskb/assets/css/default-skin/default-skin.css">
<title>mxsdoc.JavaScriptRunner.ms</title>
<script src="https://imaoki.github.io/mxskb/assets/js/smooth-scroll.min.js"></script>
<script src="https://imaoki.github.io/mxskb/assets/js/photoswipe.min.js"></script>
<script src="https://imaoki.github.io/mxskb/assets/js/photoswipe-ui-default.min.js"></script>
<script src="https://imaoki.github.io/mxskb/assets/js/photoswipe-simplify.min.js"></script>
<script src="https://imaoki.github.io/mxskb/assets/js/highlight.min.js"></script>
<script src="https://imaoki.github.io/mxskb/assets/js/mxskb.min.js"></script>
<script src="https://imaoki.github.io/mxskb/assets/js/init-main.min.js"></script>
</head>
<body class="page wrapper">
<header class="page header">
<h1 class="page title"><a class="static" href="index.html">mxsdoc</a></h1>
<ul class="hlist page nav"></ul>
</header>
<main class="page main">
<article class="post wrapper">
<header class="post header">
<h2 class="post title"><a class="static" href="">JavaScriptRunner.ms</a></h2>
<ul class="hlist right post property">
<li class="item"><time class="icon date updated">2022-04-01</time></li>
</ul>
</header>
<div class="table-of-contents"><ul><li><a href="#javascriptrunnerstruct">JavaScriptRunnerStruct</a><ul><li><a href="#_cp1_">_CP1_</a></li><li><a href="#id">id</a></li><li><a href="#handlername">handlerName</a></li><li><a href="#instancename">instanceName</a></li><li><a href="#uri">uri</a></li><li><a href="#uriclass">uriClass</a></li><li><a href="#pathutility">pathUtility</a></li><li><a href="#webbrowser">webBrowser</a></li><li><a href="#activate">Activate</a></li><li><a href="#documentcompleted">DocumentCompleted</a></li><li><a href="#eval">Eval</a></li><li><a href="#getdocumentmode">GetDocumentMode</a></li><li><a href="#geturi">GetUri</a></li><li><a href="#getuseragent">GetUserAgent</a></li><li><a href="#install">Install</a></li><li><a href="#invoke">Invoke</a></li><li><a href="#seturi">SetUri</a></li><li><a href="#uninstall">Uninstall</a></li><li><a href="#definevariablenames">defineVariableNames</a></li><li><a href="#dispose">dispose</a></li><li><a href="#generateid">generateId</a></li><li><a href="#isinstanceofhtmldocument">isInstanceOfHtmlDocument</a></li><li><a href="#isinstanceofuri">isInstanceOfUri</a></li><li><a href="#isvalidhandler">isValidHandler</a></li><li><a href="#isvalidinstance">isValidInstance</a></li><li><a href="#registerglobals">registerGlobals</a></li><li><a href="#unregisterglobals">unregisterGlobals</a></li><li><a href="#version">version</a></li><li><a href="#structname">StructName</a></li><li><a href="#dump">Dump</a></li><li><a href="#equals">Equals</a></li><li><a href="#getversion">GetVersion</a></li><li><a href="#statechanged">StateChanged</a></li></ul></li></ul></div>
<main class="post main" data-pswp>
<dl><dt>依存</dt><dd><ul>
<li><code><a href="startuploader-startuploader.html">startupLoader</a></code></li>
<li><code><a href="standard-standard.html">std</a></code></li>
</ul></dd></dl>
<h3 id="javascriptrunnerstruct">struct&nbsp;JavaScriptRunnerStruct</h3>
<p>MAXScriptからJavaScriptを実行する。</p><dl>
<dt>補足</dt>
<dd><p>ECMAScript5に対応するためには<code>WebBrowser</code>のドキュメントモードが<code>11</code>以上でなければならない。<br />
ドキュメントモードの明示的な指定はHTMLファイルに以下の<code>meta</code>要素を記述することで可能。</p>
<pre><code class="language-html">&lt;meta http-equiv='x-ua-compatible' content='ie=edge'&gt;
</code></pre></dd>
</dl>
<h4 id="_cp1_">public&nbsp;_CP1_</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>作成パラメータ1。JavaScriptを定義したHTMLファイルのURI文字列。</p></dd>
</dl>
<h4 id="id">private&nbsp;id</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>グローバル変数名に使用する一意の識別子。</p></dd>
</dl>
<h4 id="handlername">private&nbsp;handlerName</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>イベントハンドラを格納するグローバル変数の名前。</p></dd>
</dl>
<h4 id="instancename">private&nbsp;instanceName</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>自己のインスタンスを格納するグローバル変数の名前。</p></dd>
</dl>
<h4 id="uri">private&nbsp;uri</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;DotNetObject:<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.uri?view=netframework-4.8">System.Uri</a>&gt;</code></dd>
<dd><p>JavaScriptを定義したHTMLファイルのURI。</p></dd>
</dl>
<h4 id="uriclass">private&nbsp;uriClass</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;DotNetClass:<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.uri?view=netframework-4.8">System.Uri</a>&gt;</code></dd>
</dl>
<h4 id="pathutility">private&nbsp;pathUtility</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;Struct:PathUtilityStruct&gt;</code></dd>
</dl>
<h4 id="webbrowser">private&nbsp;webBrowser</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;DotNetObject:<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.windows.forms.webbrowser?view=netframework-4.8">System.Windows.Forms.WebBrowser</a>&gt;</code></dd>
</dl>
<h4 id="activate">public&nbsp;fn&nbsp;Activate</h4>
<p><code>uri</code>のHTMLファイルを読み込み、読み込みの完了をオブザーバに通知する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<dl>
<dt>補足</dt>
<dd><p>実行時の大まかな処理の流れは以下のようになる。</p>
<ol>
<li><p><code>JavaScriptRunner</code>のインスタンスを生成</p>
</li>
<li><p>HTMLの読み込み完了を受けるイベントハンドラを登録</p>
</li>
<li><p><code>Activate</code>メソッドの呼び出しによりHTMLの読み込みを開始</p>
</li>
<li><p>HTMLの読み込み完了後、非同期処理によりイベントハンドラが呼ばれる</p>
</li>
<li><p>登録したオブザーバに読み込み完了を通知</p>
</li>
<li><p>通知を受け取ったオブザーバ内で<code>Invoke</code>メソッドを呼び出して任意のJavaScript関数を実行。</p>
</li>
<li><p>イベントハンドラを登録解除し、一連の処理に使用したグローバル変数を削除</p>
</li>
</ol>
<p>利用者側はオブザーバがエントリポイントとなるように設計しなければならない。<br />
具体的な実装例はテストを参照すること。</p></dd>
</dl>
<h4 id="documentcompleted">public&nbsp;fn&nbsp;DocumentCompleted</h4>
<p><code>WebBrowser</code>の<code>DocumentCompleted</code>イベントに登録するイベントハンドラ。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<dl>
<dt>補足</dt>
<dd><p>通知完了後にグローバル変数を削除する。</p></dd>
</dl>
<h4 id="eval">public&nbsp;fn&nbsp;Eval</h4>
<p>JavaScriptの<code>eval</code>関数を実行する。</p><dl>
<dt>パラメータ</dt>
<dd><code>input</code></dd>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>JavaScriptコード。</p></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;Any&gt;</code></dd>
</dl>
<h4 id="getdocumentmode">public&nbsp;fn&nbsp;GetDocumentMode</h4>
<p><code>WebBrowser</code>のドキュメントモードを取得する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;Integer&gt;</code></dd>
</dl>
<h4 id="geturi">public&nbsp;fn&nbsp;GetUri</h4>
<p>現在の<code>uri</code>を取得する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;DotNetObject:<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.uri?view=netframework-4.8">System.Uri</a>|UndefinedClass&gt;</code></dd>
</dl>
<h4 id="getuseragent">public&nbsp;fn&nbsp;GetUserAgent</h4>
<p><code>WebBrowser</code>のユーザエージェント文字列を取得する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;Integer&gt;</code></dd>
</dl>
<h4 id="install">public&nbsp;fn&nbsp;Install</h4>
<p>インストールする。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<dl>
<dt>補足</dt>
<dd><p>静的メソッド。</p></dd>
</dl>
<h4 id="invoke">public&nbsp;fn&nbsp;Invoke</h4>
<p><code>uri</code>のHTMLファイルに定義されたJavaScript関数を実行する。</p><dl>
<dt>パラメータ</dt>
<dd><code>methodName</code></dd>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>関数名。</p></dd>
</dl>
<dl>
<dt>パラメータ</dt>
<dd><code>arguments</code></dd>
<dd><code>&lt;Array[&lt;Any&gt;]&gt;</code></dd>
<dd><p>関数に渡す引数。</p></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;Any|UndefinedClass&gt;</code></dd>
<dd><p>JavaScript関数の実行結果。ページが読み込まれていない場合は<code>undefined</code>を返す。</p></dd>
</dl>
<h4 id="seturi">public&nbsp;fn&nbsp;SetUri</h4>
<p>HTMLファイルのパスを設定する。</p><dl>
<dt>パラメータ</dt>
<dd><code>input</code></dd>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>パス文字列。</p></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;DotNetObject:<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.uri?view=netframework-4.8">System.Uri</a>&gt;</code></dd>
</dl>
<h4 id="uninstall">public&nbsp;fn&nbsp;Uninstall</h4>
<p>アンインストールする。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<dl>
<dt>補足</dt>
<dd><p>静的メソッド。</p></dd>
</dl>
<h4 id="definevariablenames">private&nbsp;fn&nbsp;defineVariableNames</h4>
<p>イベントハンドラ、およびインスタンスの格納先となるグローバル変数の名前を決定する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<h4 id="dispose">private&nbsp;fn&nbsp;dispose</h4>
<p>イベントハンドラの削除、およびグローバル変数の削除を行う。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<h4 id="generateid">private&nbsp;fn&nbsp;generateId</h4>
<p>システム時間を基に11桁の数字文字列を生成する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;String&gt;</code></dd>
</dl>
<h4 id="isinstanceofhtmldocument">private&nbsp;fn&nbsp;isInstanceOfHtmlDocument</h4>
<dl>
<dt>パラメータ</dt>
<dd><code>obj</code></dd>
<dd><code>&lt;Any&gt;</code></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;BooleanClass&gt;</code></dd>
</dl>
<h4 id="isinstanceofuri">private&nbsp;fn&nbsp;isInstanceOfUri</h4>
<dl>
<dt>パラメータ</dt>
<dd><code>obj</code></dd>
<dd><code>&lt;Any&gt;</code></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;BooleanClass&gt;</code></dd>
</dl>
<h4 id="isvalidhandler">private&nbsp;fn&nbsp;isValidHandler</h4>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;BooleanClass&gt;</code></dd>
</dl>
<h4 id="isvalidinstance">private&nbsp;fn&nbsp;isValidInstance</h4>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;BooleanClass&gt;</code></dd>
</dl>
<h4 id="registerglobals">private&nbsp;fn&nbsp;registerGlobals</h4>
<p>自己のインスタンスとイベントハンドラのグローバル変数を登録する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<h4 id="unregisterglobals">private&nbsp;fn&nbsp;unregisterGlobals</h4>
<p>登録したグローバル変数を削除する。</p><dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<h4 id="version">private&nbsp;version</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;String&gt;</code></dd>
<dd><p>バージョン番号。メジャー、マイナー、パッチの順。</p></dd>
</dl>
<h4 id="structname">public&nbsp;fn&nbsp;StructName</h4>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;Name&gt;</code></dd>
</dl>
<h4 id="dump">public&nbsp;fn&nbsp;Dump</h4>
<dl>
<dt>パラメータ</dt>
<dd><code>indent:</code></dd>
<dd><code>&lt;String&gt;</code></dd>
</dl>
<dl>
<dt>パラメータ</dt>
<dd><code>out:</code></dd>
<dd><code>&lt;FileStream|StringStream|WindowStream&gt;</code></dd>
<dd><p>出力先。既定値は<code>listener</code>。</p></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;OkClass&gt;</code></dd>
</dl>
<h4 id="equals">public&nbsp;fn&nbsp;Equals</h4>
<dl>
<dt>パラメータ</dt>
<dd><code>obj</code></dd>
<dd><code>&lt;Any&gt;</code></dd>
</dl>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;BooleanClass&gt;</code></dd>
</dl>
<dl>
<dt>補足</dt>
<dd><p>大文字と小文字を区別する。</p></dd>
</dl>
<h4 id="getversion">public&nbsp;fn&nbsp;GetVersion</h4>
<dl>
<dt>戻り値</dt>
<dd><code>&lt;String&gt;</code></dd>
</dl>
<h4 id="statechanged">public&nbsp;StateChanged</h4>
<dl>
<dt>プロパティ</dt>
<dd><code>&lt;Struct:ObservableStruct&gt;</code></dd>
</dl>
</main>
</article>
</main>
<footer class="page footer">
<ul class="hlist"><li class="item"><p>Generated by DocGenerator</p></li></ul>
</footer>
</body>
</html>
